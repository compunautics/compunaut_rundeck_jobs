- defaultTab: monitor
  description: |-
    Use this job to decommission a node from Influxdb.
    - This job will execute on all db servers, removing all collected node metrics for the specified node.
  executionEnabled: true
  group: Linux
  loglevel: INFO
  name: Decommission node from Influxdb
  nodeFilterEditable: false
  nodefilters:
    dispatch:
      excludePrecedence: true
      keepgoing: true
      rankOrder: ascending
      successOnEmptyNodeFilter: false
      threadcount: '3'
    filter: 'name: .*db.*'
  nodesSelectedByDefault: true
  options:
  - description: Specify the name of the node to be removed from influxdb.
    name: node_to_remove
    required: true
    value: node.domain.name
  scheduleEnabled: true
  sequence:
    commands:
    - description: Delete the node from influxdb
      exec: sudo influx --database=compunaut_telegraf -execute "drop series where host='${option.node_to_remove}'"
    keepgoing: false
    strategy: node-first
  timeout: '300'

