- defaultTab: monitor
  description: Use this job to decommission printers from saltstack, consul, and influxdb.
  executionEnabled: true
  group: Netboot
  id: 0e445156-c9e2-4655-a644-fe4d752d6c00
  loglevel: INFO
  name: Decommission Printers
  nodeFilterEditable: false
  nodefilters:
    dispatch:
      excludePrecedence: true
      keepgoing: false
      rankOrder: ascending
      successOnEmptyNodeFilter: false
      threadcount: '1'
    filter: 'name: .*salt.*'
  nodesSelectedByDefault: true
  options:
  - description: Specify the name of the printer that you would like to decommission.
    name: node_to_decommission
    regex: .*-prtr.*
    required: true
    value: .*-prtr.domain.name
  scheduleEnabled: true
  sequence:
    commands:
    - description: Delete node key
      jobref:
        args: -key_to_delete ${option.node_to_decommission}
        group: Saltstack
        name: Delete Keys
        nodeStep: 'true'
    - description: Delete node from Consul
      jobref:
        args: -node_to_remove ${option.node_to_decommission}
        group: Linux
        name: Decommission node from Consul
        nodeStep: 'true'
    - description: Delete node from Influxdb
      jobref:
        args: -node_to_remove ${option.node_to_decommission}
        group: Linux
        name: Decommission node from Influxdb
        nodeStep: 'true'
    keepgoing: false
    strategy: node-first
  timeout: '300'
